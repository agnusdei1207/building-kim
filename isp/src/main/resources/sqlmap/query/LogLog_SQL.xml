<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.open.LogLog">
	
	<sql id="Where"> 
		<if test="searchKeyword !=null and searchKeyword !=''">
			<if test="searchCondition !=null and searchCondition !='' and searchCondition ==0">
				AND (LOG_TITLE LIKE CONCAT('%',#{searchKeyword},'%') OR LOG_CONT LIKE CONCAT('%',#{searchKeyword},'%'))
			</if>
			<if test="searchCondition !=null and searchCondition !='' and searchCondition ==1">
				AND LOG_TITLE LIKE CONCAT('%',#{searchKeyword},'%')
			</if>
			<if test="searchCondition !=null and searchCondition !='' and searchCondition ==2">
				AND LOG_CONT LIKE CONCAT('%',#{searchKeyword},'%')
			</if>
	 	</if> 
	</sql>         
       
	<select id="selectContents" parameterType="logLogVO" resultType="logLogVO">
		/* LogLog.selectContents */
		<![CDATA[
			 SELECT  
			          
				  LOG_SEQ															 logSeq
				, LOG_CLIENT_IP 								 					 logClientIp
				, F_USER_NM(LOG_ID)													 logId
				, LOG_URL														     logUrl
				, DATE_FORMAT(LOG_DT,'%Y.%m.%d')									 logDt
				, LOG_DIVN 															 logDivn
				, LOG_IP_ERR_YN 													 logIpErrYn
				
		     FROM  T_LOG_LOG
				 AND LOG_SEQ = #{logSeq}
		]]>
	</select>
	 
	<select id="selectList" parameterType="cmmnDefaultVO" resultType="logLogVO">
		/* LogLog.selectList */
		<![CDATA[  
      	     SELECT       
      	        
				  LOG_SEQ															 logSeq
				, LOG_CLIENT_IP 								 					 logClientIp
				, F_USER_NM(LOG_ID)													 logId
				, LOG_URL														     logUrl
				, DATE_FORMAT(LOG_DT,'%Y.%m.%d')									 logDt
				, LOG_DIVN 															 logDivn
				, LOG_IP_ERR_YN 													 logIpErrYn
				
		     FROM T_LOG_LOG
	      ]]>   
		     <include refid="Where"/>	 
	     <![CDATA[    
	    		ORDER BY LOG_SEQ DESC
				LIMIT  #{firstIndex} , #{recordCountPerPage}
		]]>
	</select>	


	<select id="selectCount" parameterType="cmmnDefaultVO" resultType="int">
		/* LogLog.selectCount */
		<![CDATA[ 
			SELECT 
				COUNT(LOG_SEQ) logCnt  
			FROM T_LOG_LOG
		]]>
			 <include refid="Where"/>
	</select> 
	
	<insert id="insertContents" parameterType="logLogVO">
		/* LogLog.insertContents */
		<![CDATA[
			INSERT INTO T_LOG_LOG(
           	  	  LOG_SEQ												
				, LOG_CLIENT_IP 								 				
				, LOG_ID														
				, LOG_URL													
				, LOG_DIVN 														
				, LOG_IP_ERR_YN 																		  						
			)        
			VALUES (
				 (SELECT IFNULL(MAX(TL.LOG_SEQ)+1,1) FROM T_LOG_LOG TL)
				,#{logClientIp      }          
				,#{loginSeq 		}  
				,#{logUrl   	    }
				,#{logDivn          }
				,#{logIpErrYn       }
			)
		]]>
	</insert>
	
	<update id="updateContents" parameterType="logLogVO">
		/* LogLog.updateContents */
		<![CDATA[
			UPDATE T_LOG_LOG        
			 SET     
			        
				LOG_CLIENT_IP 								 						 =#{logClientIp}
				, LOG_URL														     =#{logUrl     }
				, LOG_DT															 =#{logDt      }
				, LOG_DIVN 															 =#{logDivn    }
				, LOG_IP_ERR_YN 													 =#{logIpErrYn }
				
			WHERE  LOG_SEQ = #{logSeq}    
		]]>    
	</update> 
	    
	<update id="deleteContents" parameterType="logLogVO">
		/* LogLog.deleteContents */
		<![CDATA[    
			UPDATE T_LOG_LOG
		       SET
			WHERE LOG_SEQ=#{logSeq}
		]]>  
	</update>
    
</mapper>